//
// Academic License - for use in teaching, academic research, and meeting
// course requirements at degree granting institutions only.  Not for
// government, commercial, or other organizational use.
//
// File: fre2017.cpp
//
// Code generated for Simulink model 'fre2017'.
//
// Model version                  : 1.17
// Simulink Coder version         : 8.12 (R2017a) 16-Feb-2017
// C/C++ source code generated on : Wed Jun 14 18:10:58 2017
//
// Target selection: ert.tlc
// Embedded hardware selection: Generic->Unspecified (assume 32-bit Generic)
// Code generation objectives: Unspecified
// Validation result: Not run
//
#include "fre2017.h"
#include "fre2017_private.h"

// Named constants for Chart: '<Root>/Chart'
#define fre2017_IN_Automatic           ((uint8_T)1U)
#define fre2017_IN_DriveOnRows         ((uint8_T)1U)
#define fre2017_IN_InRow               ((uint8_T)1U)
#define fre2017_IN_Manual              ((uint8_T)2U)
#define fre2017_IN_NO_ACTIVE_CHILD     ((uint8_T)0U)
#define fre2017_IN_StartFirstMeter     ((uint8_T)2U)
#define fre2017_IN_Stop                ((uint8_T)3U)
#define fre2017_IN_Turn                ((uint8_T)2U)
#define fre2017_IN_TurnLeft            ((uint8_T)3U)
#define fre2017_IN_TurnRight           ((uint8_T)4U)
#define fre2017_IN_WaitLeft            ((uint8_T)5U)
#define fre2017_IN_WaitRight           ((uint8_T)6U)
#define fre2017_MessageQueueLen        (1)

// Block signals (auto storage)
B_fre2017_T fre2017_B;

// Block states (auto storage)
DW_fre2017_T fre2017_DW;

// Real-time model
RT_MODEL_fre2017_T fre2017_M_;
RT_MODEL_fre2017_T *const fre2017_M = &fre2017_M_;

// Forward declaration for local functions
static void fre2017_exit_internal_Automatic(void);
static void fre2017_Automatic(const real_T *Gain1, const real_T *Gain, const
  int32_T row[64], int32_T direction[64]);
static real_T fre2017_rt_atan2d_snf_cordic11(real_T u0, real_T u1);

// Function for Chart: '<Root>/Chart'
static void fre2017_exit_internal_Automatic(void)
{
  // Exit Internal 'Automatic': '<S2>:39'
  switch (fre2017_DW.is_Automatic) {
   case fre2017_IN_StartFirstMeter:
    // Exit 'StartFirstMeter': '<S2>:64'
    // '<S2>:64:1' straightOn = false;
    fre2017_B.straightOn = false;

    // '<S2>:64:3' i=1;
    fre2017_DW.i = 1.0;
    fre2017_DW.is_Automatic = fre2017_IN_NO_ACTIVE_CHILD;
    break;

   case fre2017_IN_TurnLeft:
    // Exit Internal 'TurnLeft': '<S2>:11'
    switch (fre2017_DW.is_TurnLeft) {
     case fre2017_IN_DriveOnRows:
      // Exit 'DriveOnRows': '<S2>:12'
      // '<S2>:12:1' straightOn = false;
      fre2017_B.straightOn = false;
      fre2017_DW.is_TurnLeft = fre2017_IN_NO_ACTIVE_CHILD;
      break;

     case fre2017_IN_Turn:
      // Exit 'Turn': '<S2>:4'
      // '<S2>:4:1' leftTurn = false;
      fre2017_B.leftTurn = false;
      fre2017_DW.is_TurnLeft = fre2017_IN_NO_ACTIVE_CHILD;
      break;
    }

    // Exit 'TurnLeft': '<S2>:11'
    // '<S2>:11:1' i = i + 1;
    fre2017_DW.i++;
    fre2017_DW.is_Automatic = fre2017_IN_NO_ACTIVE_CHILD;
    break;

   case fre2017_IN_TurnRight:
    // Exit Internal 'TurnRight': '<S2>:27'
    switch (fre2017_DW.is_TurnRight) {
     case fre2017_IN_DriveOnRows:
      // Exit 'DriveOnRows': '<S2>:31'
      // '<S2>:31:1' straightOn = false;
      fre2017_B.straightOn = false;
      fre2017_DW.is_TurnRight = fre2017_IN_NO_ACTIVE_CHILD;
      break;

     case fre2017_IN_Turn:
      // Exit 'Turn': '<S2>:30'
      // '<S2>:30:1' rightTurn = false;
      fre2017_B.rightTurn = false;
      fre2017_DW.is_TurnRight = fre2017_IN_NO_ACTIVE_CHILD;
      break;
    }

    // Exit 'TurnRight': '<S2>:27'
    // '<S2>:27:1' i = i + 1;
    fre2017_DW.i++;
    fre2017_DW.is_Automatic = fre2017_IN_NO_ACTIVE_CHILD;
    break;

   default:
    fre2017_DW.is_Automatic = fre2017_IN_NO_ACTIVE_CHILD;
    break;
  }
}

// Function for Chart: '<Root>/Chart'
static void fre2017_Automatic(const real_T *Gain1, const real_T *Gain, const
  int32_T row[64], int32_T direction[64])
{
  int32_T q0;

  // During 'Automatic': '<S2>:39'
  // '<S2>:85:1' sf_internal_predicateOutput = ...
  // '<S2>:85:1' patternDirection(i) == 0;
  if (direction[(int32_T)fre2017_DW.i - 1] == 0) {
    // Transition: '<S2>:85'
    fre2017_exit_internal_Automatic();
    fre2017_DW.is_c3_fre2017 = fre2017_IN_Stop;

    // Entry 'Stop': '<S2>:86'
    // '<S2>:86:1' inReihe = false;
    fre2017_B.inReihe = false;

    // '<S2>:86:1' rightTurn = false;
    fre2017_B.rightTurn = false;

    // '<S2>:86:3' leftTurn = false;
    fre2017_B.leftTurn = false;

    // '<S2>:86:4' straightOn = false;
    fre2017_B.straightOn = false;

    // '<S2>:86:5' manual = true
    fre2017_B.manual = true;
  } else {
    // '<S2>:61:1' sf_internal_predicateOutput = ...
    // '<S2>:61:1' state == false;
    if (!fre2017_B.In1_e.Data) {
      // Transition: '<S2>:61'
      fre2017_exit_internal_Automatic();
      fre2017_DW.is_c3_fre2017 = fre2017_IN_Manual;

      // Entry 'Manual': '<S2>:38'
      // '<S2>:38:1' manual = true;
      fre2017_B.manual = true;
    } else {
      switch (fre2017_DW.is_Automatic) {
       case fre2017_IN_InRow:
        fre2017_B.inReihe = true;

        // Constant: '<Root>/safety_trashhold'
        // During 'InRow': '<S2>:1'
        // '<S2>:5:1' sf_internal_predicateOutput = ...
        // '<S2>:5:1' left_row_safety < safety_trashhold && right_row_safety < safety_trashhold && direction == 1; 
        if ((*Gain1 < fre2017_P.safety_trashhold_Value) && (*Gain <
             fre2017_P.safety_trashhold_Value) && (fre2017_DW.direction == 1)) {
          // Transition: '<S2>:5'
          fre2017_DW.is_Automatic = fre2017_IN_WaitLeft;
          fre2017_DW.temporalCounter_i1 = 0U;
        } else {
          // '<S2>:73:1' sf_internal_predicateOutput = ...
          // '<S2>:73:1' left_row_safety < safety_trashhold && right_row_safety < safety_trashhold && direction == 2; 
          if ((*Gain1 < fre2017_P.safety_trashhold_Value) && (*Gain <
               fre2017_P.safety_trashhold_Value) && (fre2017_DW.direction == 2))
          {
            // Transition: '<S2>:73'
            fre2017_DW.is_Automatic = fre2017_IN_WaitRight;
            fre2017_DW.temporalCounter_i1 = 0U;
          }
        }
        break;

       case fre2017_IN_StartFirstMeter:
        // During 'StartFirstMeter': '<S2>:64'
        // '<S2>:65:1' sf_internal_predicateOutput = ...
        // '<S2>:65:1' after(1,sec);
        if (fre2017_DW.temporalCounter_i1 >= 100U) {
          // Transition: '<S2>:65'
          // Exit 'StartFirstMeter': '<S2>:64'
          // '<S2>:64:1' straightOn = false;
          fre2017_B.straightOn = false;

          // '<S2>:64:3' i=1;
          fre2017_DW.i = 1.0;
          fre2017_DW.is_Automatic = fre2017_IN_InRow;

          // Entry 'InRow': '<S2>:1'
          // '<S2>:1:1' direction = patternDirection(i);
          fre2017_DW.direction = direction[(int32_T)fre2017_DW.i - 1];

          // '<S2>:1:2' inReihe = true;
          fre2017_B.inReihe = true;
        }
        break;

       case fre2017_IN_TurnLeft:
        fre2017_B.inReihe = false;

        // Constant: '<Root>/safety_trashhold'
        // During 'TurnLeft': '<S2>:11'
        // '<S2>:6:1' sf_internal_predicateOutput = ...
        // '<S2>:6:1' left_row_safety >= safety_trashhold && right_row_safety >= safety_trashhold; 
        if ((*Gain1 >= fre2017_P.safety_trashhold_Value) && (*Gain >=
             fre2017_P.safety_trashhold_Value)) {
          // Transition: '<S2>:6'
          // Exit Internal 'TurnLeft': '<S2>:11'
          switch (fre2017_DW.is_TurnLeft) {
           case fre2017_IN_DriveOnRows:
            // Exit 'DriveOnRows': '<S2>:12'
            // '<S2>:12:1' straightOn = false;
            fre2017_B.straightOn = false;
            fre2017_DW.is_TurnLeft = fre2017_IN_NO_ACTIVE_CHILD;
            break;

           case fre2017_IN_Turn:
            // Exit 'Turn': '<S2>:4'
            // '<S2>:4:1' leftTurn = false;
            fre2017_B.leftTurn = false;
            fre2017_DW.is_TurnLeft = fre2017_IN_NO_ACTIVE_CHILD;
            break;
          }

          // Exit 'TurnLeft': '<S2>:11'
          // '<S2>:11:1' i = i + 1;
          fre2017_DW.i++;
          fre2017_DW.is_Automatic = fre2017_IN_InRow;

          // Entry 'InRow': '<S2>:1'
          // '<S2>:1:1' direction = patternDirection(i);
          fre2017_DW.direction = direction[(int32_T)fre2017_DW.i - 1];

          // '<S2>:1:2' inReihe = true;
          fre2017_B.inReihe = true;
        } else if (fre2017_DW.is_TurnLeft == fre2017_IN_DriveOnRows) {
          // During 'DriveOnRows': '<S2>:12'
          // '<S2>:15:1' sf_internal_predicateOutput = ...
          // '<S2>:15:1' after(patternRow(i)-1,sec);
          q0 = row[(int32_T)fre2017_DW.i - 1];
          if (q0 < -2147483647) {
            q0 = MIN_int32_T;
          } else {
            q0--;
          }

          if (fre2017_DW.temporalCounter_i1 >= (uint32_T)(q0 * 100)) {
            // Transition: '<S2>:15'
            // Exit 'DriveOnRows': '<S2>:12'
            // '<S2>:12:1' straightOn = false;
            fre2017_B.straightOn = false;
            fre2017_DW.is_TurnLeft = fre2017_IN_Turn;
            fre2017_DW.temporalCounter_i1 = 0U;

            // Entry 'Turn': '<S2>:4'
            // '<S2>:4:1' leftTurn = true;
            fre2017_B.leftTurn = true;
          }
        } else {
          // Constant: '<Root>/turn_time'
          // During 'Turn': '<S2>:4'
          // '<S2>:14:1' sf_internal_predicateOutput = ...
          // '<S2>:14:1' after(turn_time,sec) && patternRow(i) > 1;
          if ((fre2017_DW.temporalCounter_i1 >= (uint32_T)ceil
               (fre2017_P.turn_time_Value * 100.0)) && (row[(int32_T)
               fre2017_DW.i - 1] > 1)) {
            // Transition: '<S2>:14'
            // Exit 'Turn': '<S2>:4'
            // '<S2>:4:1' leftTurn = false;
            fre2017_B.leftTurn = false;
            fre2017_DW.is_TurnLeft = fre2017_IN_DriveOnRows;
            fre2017_DW.temporalCounter_i1 = 0U;

            // Entry 'DriveOnRows': '<S2>:12'
            // '<S2>:12:1' straightOn = true;
            fre2017_B.straightOn = true;
          }
        }
        break;

       case fre2017_IN_TurnRight:
        fre2017_B.inReihe = false;

        // Constant: '<Root>/safety_trashhold'
        // During 'TurnRight': '<S2>:27'
        // '<S2>:79:1' sf_internal_predicateOutput = ...
        // '<S2>:79:1' left_row_safety >= safety_trashhold && right_row_safety >= safety_trashhold; 
        if ((*Gain1 >= fre2017_P.safety_trashhold_Value) && (*Gain >=
             fre2017_P.safety_trashhold_Value)) {
          // Transition: '<S2>:79'
          // Exit Internal 'TurnRight': '<S2>:27'
          switch (fre2017_DW.is_TurnRight) {
           case fre2017_IN_DriveOnRows:
            // Exit 'DriveOnRows': '<S2>:31'
            // '<S2>:31:1' straightOn = false;
            fre2017_B.straightOn = false;
            fre2017_DW.is_TurnRight = fre2017_IN_NO_ACTIVE_CHILD;
            break;

           case fre2017_IN_Turn:
            // Exit 'Turn': '<S2>:30'
            // '<S2>:30:1' rightTurn = false;
            fre2017_B.rightTurn = false;
            fre2017_DW.is_TurnRight = fre2017_IN_NO_ACTIVE_CHILD;
            break;
          }

          // Exit 'TurnRight': '<S2>:27'
          // '<S2>:27:1' i = i + 1;
          fre2017_DW.i++;
          fre2017_DW.is_Automatic = fre2017_IN_InRow;

          // Entry 'InRow': '<S2>:1'
          // '<S2>:1:1' direction = patternDirection(i);
          fre2017_DW.direction = direction[(int32_T)fre2017_DW.i - 1];

          // '<S2>:1:2' inReihe = true;
          fre2017_B.inReihe = true;
        } else if (fre2017_DW.is_TurnRight == fre2017_IN_DriveOnRows) {
          // During 'DriveOnRows': '<S2>:31'
          // '<S2>:28:1' sf_internal_predicateOutput = ...
          // '<S2>:28:1' after(patternRow(i)-1,sec);
          q0 = row[(int32_T)fre2017_DW.i - 1];
          if (q0 < -2147483647) {
            q0 = MIN_int32_T;
          } else {
            q0--;
          }

          if (fre2017_DW.temporalCounter_i1 >= (uint32_T)(q0 * 100)) {
            // Transition: '<S2>:28'
            // Exit 'DriveOnRows': '<S2>:31'
            // '<S2>:31:1' straightOn = false;
            fre2017_B.straightOn = false;
            fre2017_DW.is_TurnRight = fre2017_IN_Turn;
            fre2017_DW.temporalCounter_i1 = 0U;

            // Entry 'Turn': '<S2>:30'
            // '<S2>:30:1' rightTurn = true;
            fre2017_B.rightTurn = true;
          }
        } else {
          // Constant: '<Root>/turn_time'
          // During 'Turn': '<S2>:30'
          // '<S2>:29:1' sf_internal_predicateOutput = ...
          // '<S2>:29:1' after(turn_time,sec) && patternRow(i) > 1;
          if ((fre2017_DW.temporalCounter_i1 >= (uint32_T)ceil
               (fre2017_P.turn_time_Value * 100.0)) && (row[(int32_T)
               fre2017_DW.i - 1] > 1)) {
            // Transition: '<S2>:29'
            // Exit 'Turn': '<S2>:30'
            // '<S2>:30:1' rightTurn = false;
            fre2017_B.rightTurn = false;
            fre2017_DW.is_TurnRight = fre2017_IN_DriveOnRows;
            fre2017_DW.temporalCounter_i1 = 0U;

            // Entry 'DriveOnRows': '<S2>:31'
            // '<S2>:31:1' straightOn = true;
            fre2017_B.straightOn = true;
          }
        }
        break;

       case fre2017_IN_WaitLeft:
        // Constant: '<Root>/row_end_time'
        // During 'WaitLeft': '<S2>:66'
        // '<S2>:67:1' sf_internal_predicateOutput = ...
        // '<S2>:67:1' after(row_end_delay,sec);
        if (fre2017_DW.temporalCounter_i1 >= (uint32_T)ceil
            (fre2017_P.row_end_time_Value * 100.0)) {
          // Constant: '<Root>/safety_trashhold'
          // Transition: '<S2>:67'
          // '<S2>:68:1' sf_internal_predicateOutput = ...
          // '<S2>:68:1' left_row_safety >= safety_trashhold || right_row_safety >= safety_trashhold; 
          if ((*Gain1 >= fre2017_P.safety_trashhold_Value) || (*Gain >=
               fre2017_P.safety_trashhold_Value)) {
            // Transition: '<S2>:68'
            fre2017_DW.is_Automatic = fre2017_IN_InRow;

            // Entry 'InRow': '<S2>:1'
            // '<S2>:1:1' direction = patternDirection(i);
            fre2017_DW.direction = direction[(int32_T)fre2017_DW.i - 1];

            // '<S2>:1:2' inReihe = true;
            fre2017_B.inReihe = true;
          } else {
            // '<S2>:72:1' sf_internal_predicateOutput = ...
            // '<S2>:72:1' direction == 1;
            if (fre2017_DW.direction == 1) {
              // Transition: '<S2>:72'
              fre2017_DW.is_Automatic = fre2017_IN_TurnLeft;

              // Entry 'TurnLeft': '<S2>:11'
              // '<S2>:11:1' inReihe = false;
              fre2017_B.inReihe = false;

              // Entry Internal 'TurnLeft': '<S2>:11'
              // Transition: '<S2>:13'
              // '<S2>:13:1' a=1
              fre2017_DW.is_TurnLeft = fre2017_IN_Turn;
              fre2017_DW.temporalCounter_i1 = 0U;

              // Entry 'Turn': '<S2>:4'
              // '<S2>:4:1' leftTurn = true;
              fre2017_B.leftTurn = true;
            }
          }
        }
        break;

       default:
        // Constant: '<Root>/row_end_time'
        // During 'WaitRight': '<S2>:75'
        // '<S2>:76:1' sf_internal_predicateOutput = ...
        // '<S2>:76:1' after(row_end_delay,sec);
        if (fre2017_DW.temporalCounter_i1 >= (uint32_T)ceil
            (fre2017_P.row_end_time_Value * 100.0)) {
          // Transition: '<S2>:76'
          // '<S2>:78:1' sf_internal_predicateOutput = ...
          // '<S2>:78:1' direction == 2;
          if (fre2017_DW.direction == 2) {
            // Transition: '<S2>:78'
            fre2017_DW.is_Automatic = fre2017_IN_TurnRight;

            // Entry 'TurnRight': '<S2>:27'
            // '<S2>:27:1' inReihe = false;
            fre2017_B.inReihe = false;

            // Entry Internal 'TurnRight': '<S2>:27'
            // Transition: '<S2>:32'
            // '<S2>:32:1' a=1
            fre2017_DW.is_TurnRight = fre2017_IN_Turn;
            fre2017_DW.temporalCounter_i1 = 0U;

            // Entry 'Turn': '<S2>:30'
            // '<S2>:30:1' rightTurn = true;
            fre2017_B.rightTurn = true;
          } else {
            // Constant: '<Root>/safety_trashhold'
            // '<S2>:77:1' sf_internal_predicateOutput = ...
            // '<S2>:77:1' left_row_safety >= safety_trashhold || right_row_safety >= safety_trashhold; 
            if ((*Gain1 >= fre2017_P.safety_trashhold_Value) || (*Gain >=
                 fre2017_P.safety_trashhold_Value)) {
              // Transition: '<S2>:77'
              fre2017_DW.is_Automatic = fre2017_IN_InRow;

              // Entry 'InRow': '<S2>:1'
              // '<S2>:1:1' direction = patternDirection(i);
              fre2017_DW.direction = direction[(int32_T)fre2017_DW.i - 1];

              // '<S2>:1:2' inReihe = true;
              fre2017_B.inReihe = true;
            }
          }
        }
        break;
      }
    }
  }
}

static real_T fre2017_rt_atan2d_snf_cordic11(real_T u0, real_T u1)
{
  real_T y;
  real_T yAcc;
  boolean_T y_quad_adjust;
  boolean_T y_nonzero;
  boolean_T x_quad_adjust;
  real_T xtmp;
  real_T ytmp;
  int16_T idx;
  static const real_T atan2_cordicLUT_n11_d[11] = { 0.78539816339744828,
    0.46364760900080609, 0.24497866312686414, 0.12435499454676144,
    0.06241880999595735, 0.031239833430268277, 0.015623728620476831,
    0.0078123410601011111, 0.0039062301319669718, 0.0019531225164788188,
    0.00097656218955931946 };

  const real_T *u3;
  u3 = &atan2_cordicLUT_n11_d[0];
  if (u0 < 0.0) {
    yAcc = -u0;
    y_quad_adjust = true;
    y_nonzero = true;
  } else {
    yAcc = u0;
    y_quad_adjust = false;
    y_nonzero = (u0 > 0.0);
  }

  if (u1 < 0.0) {
    fre2017_B.xAcc = -u1;
    x_quad_adjust = true;
  } else {
    fre2017_B.xAcc = u1;
    x_quad_adjust = false;
  }

  y = 0.0;
  xtmp = fre2017_B.xAcc;
  ytmp = yAcc;
  for (idx = 0; idx < 11; idx++) {
    if (yAcc < 0.0) {
      fre2017_B.xAcc -= ytmp;
      yAcc += xtmp;
      y -= u3[idx];
    } else {
      fre2017_B.xAcc += ytmp;
      yAcc -= xtmp;
      y += u3[idx];
    }

    xtmp = ldexp(fre2017_B.xAcc, -(idx + 1));
    ytmp = ldexp(yAcc, -(idx + 1));
  }

  if (y_nonzero) {
    if (x_quad_adjust) {
      if (y_quad_adjust) {
        y -= 3.1415926535897931;
      } else {
        y = 3.1415926535897931 - y;
      }
    } else {
      if (y_quad_adjust) {
        y = -y;
      }
    }
  } else if (x_quad_adjust) {
    y = 3.1415926535897931;
  } else {
    y = 0.0;
  }

  return y;
}

// Model step function
void fre2017_step(void)
{
  // local scratch DWork variables
  int32_T ForEach_itr;
  int32_T ForEach_itr_h;
  boolean_T varargout_1;
  SL_Bus_fre2017_std_msgs_Bool varargout_2;
  int32_T i;
  int32_T i_0;
  int32_T i_1;

  // Outputs for Atomic SubSystem: '<Root>/Subscribe'
  // Start for MATLABSystem: '<S6>/SourceBlock' incorporates:
  //   Inport: '<S21>/In1'
  //   MATLABSystem: '<S6>/SourceBlock'

  varargout_1 = Sub_fre2017_5.getLatestMessage(&fre2017_B.varargout_2);

  // Outputs for Enabled SubSystem: '<S6>/Enabled Subsystem' incorporates:
  //   EnablePort: '<S21>/Enable'

  if (varargout_1) {
    fre2017_B.In1 = fre2017_B.varargout_2;
  }

  // End of Start for MATLABSystem: '<S6>/SourceBlock'
  // End of Outputs for SubSystem: '<S6>/Enabled Subsystem'
  // End of Outputs for SubSystem: '<Root>/Subscribe'

  // DataTypeConversion: '<S5>/Data Type Conversion'
  for (i_1 = 0; i_1 < 720; i_1++) {
    fre2017_B.DataTypeConversion[i_1] = fre2017_B.In1.Ranges[i_1];
  }

  // End of DataTypeConversion: '<S5>/Data Type Conversion'

  // Outputs for Iterator SubSystem: '<S5>/Box check right side' incorporates:
  //   ForEach: '<S16>/For Each'

  for (ForEach_itr = 0; ForEach_itr < 360; ForEach_itr++) {
    // Switch: '<S16>/right side of the right box' incorporates:
    //   Constant: '<S16>/zero'
    //   Constant: '<S5>/scan_angles'
    //   Fcn: '<S20>/r->x'
    //   ForEachSliceSelector: '<S16>/ImpSel_InsertedFor_scan_phi_in_at_outport_0'
    //   ForEachSliceSelector: '<S16>/ImpSel_InsertedFor_scan_r_in_at_outport_0'

    if (fre2017_B.DataTypeConversion[ForEach_itr] * cos
        (fre2017_P.scan_angles_Value[ForEach_itr]) >=
        fre2017_P.CoreSubsys_p.rightsideoftherightbox_Threshol) {
      fre2017_B.SumofElements1 = fre2017_P.CoreSubsys_p.zero_Value;
    } else {
      // Fcn: '<S20>/theta->y'
      fre2017_B.SumofElements1 = fre2017_B.DataTypeConversion[ForEach_itr] * sin
        (fre2017_P.scan_angles_Value[ForEach_itr]);

      // Switch: '<S16>/bottom side of the right box' incorporates:
      //   Abs: '<S16>/Abs1'
      //   Constant: '<S16>/zero'

      if (fabs(fre2017_B.SumofElements1) >=
          fre2017_P.CoreSubsys_p.bottomsideoftherightbox_Thresho) {
        fre2017_B.SumofElements1 = fre2017_P.CoreSubsys_p.zero_Value;
      }

      // End of Switch: '<S16>/bottom side of the right box'

      // Switch: '<S16>/bottom side of the right box1' incorporates:
      //   Abs: '<S16>/Abs2'
      //   Constant: '<S16>/zero'

      if (!(fabs(fre2017_B.SumofElements1) >=
            fre2017_P.CoreSubsys_p.bottomsideoftherightbox1_Thresh)) {
        fre2017_B.SumofElements1 = fre2017_P.CoreSubsys_p.zero_Value;
      }

      // End of Switch: '<S16>/bottom side of the right box1'
    }

    // End of Switch: '<S16>/right side of the right box'

    // ForEachSliceAssignment: '<S16>/ImpAsg_InsertedFor_scan_y_out_at_inport_0' 
    fre2017_B.ImpAsg_InsertedFor_scan_y_o[ForEach_itr] =
      fre2017_B.SumofElements1;
  }

  // End of Outputs for SubSystem: '<S5>/Box check right side'

  // Sum: '<S18>/Sum of Elements'
  i_1 = 0;
  i_0 = 0;
  fre2017_B.Preventdiv1_o = -0.0;
  for (i = 0; i < 360; i++) {
    fre2017_B.Preventdiv1_o += fre2017_B.ImpAsg_InsertedFor_scan_y_o[i];

    // Find: '<S18>/Find Nonzero Elements'
    if (fre2017_B.ImpAsg_InsertedFor_scan_y_o[i_0] != 0.0) {
      i_1++;
    }

    i_0++;
  }

  // End of Sum: '<S18>/Sum of Elements'

  // Find: '<S18>/Find Nonzero Elements'
  fre2017_DW.FindNonzeroElements_DIMS1 = i_1;

  // Selector: '<S18>/Selector'
  fre2017_DW.Selector_DIMS1 = fre2017_DW.FindNonzeroElements_DIMS1;

  // Switch: '<S18>/Prevent div 0' incorporates:
  //   Constant: '<S18>/Const1'
  //   Width: '<S18>/Width'

  if (fre2017_DW.Selector_DIMS1 != 0) {
    fre2017_B.SumofElements1 = fre2017_DW.Selector_DIMS1;
  } else {
    fre2017_B.SumofElements1 = fre2017_P.Const1_Value;
  }

  // End of Switch: '<S18>/Prevent div 0'

  // Product: '<S18>/Divide'
  fre2017_B.Divide = fre2017_B.Preventdiv1_o / fre2017_B.SumofElements1;

  // Gain: '<S18>/Gain' incorporates:
  //   Constant: '<S18>/max. Points'
  //   Product: '<S18>/Divide1'

  fre2017_B.Gain = fre2017_B.SumofElements1 / fre2017_P.maxPoints_Value *
    fre2017_P.Gain_Gain_i;

  // Outputs for Iterator SubSystem: '<S5>/Box check left side' incorporates:
  //   ForEach: '<S15>/For Each'

  for (ForEach_itr_h = 0; ForEach_itr_h < 360; ForEach_itr_h++) {
    // Switch: '<S15>/right side of the left box' incorporates:
    //   Constant: '<S15>/zero'
    //   Constant: '<S5>/scan_angles'
    //   Fcn: '<S19>/r->x'
    //   ForEachSliceSelector: '<S15>/ImpSel_InsertedFor_scan_phi_in_at_outport_0'
    //   ForEachSliceSelector: '<S15>/ImpSel_InsertedFor_scan_r_in_at_outport_0'

    if (fre2017_B.DataTypeConversion[ForEach_itr_h + 360] * cos
        (fre2017_P.scan_angles_Value[ForEach_itr_h + 360]) >=
        fre2017_P.CoreSubsys.rightsideoftheleftbox_Threshold) {
      fre2017_B.Preventdiv1_o = fre2017_P.CoreSubsys.zero_Value;
    } else {
      // Fcn: '<S19>/theta->y'
      fre2017_B.Preventdiv1_o = fre2017_B.DataTypeConversion[ForEach_itr_h + 360]
        * sin(fre2017_P.scan_angles_Value[ForEach_itr_h + 360]);

      // Switch: '<S15>/bottom side of the left box' incorporates:
      //   Abs: '<S15>/Abs1'
      //   Constant: '<S15>/zero'

      if (fabs(fre2017_B.Preventdiv1_o) >=
          fre2017_P.CoreSubsys.bottomsideoftheleftbox_Threshol) {
        fre2017_B.Preventdiv1_o = fre2017_P.CoreSubsys.zero_Value;
      }

      // End of Switch: '<S15>/bottom side of the left box'

      // Switch: '<S15>/bottom side of the right box1' incorporates:
      //   Abs: '<S15>/Abs2'
      //   Constant: '<S15>/zero'

      if (!(fabs(fre2017_B.Preventdiv1_o) >=
            fre2017_P.CoreSubsys.bottomsideoftherightbox1_Thresh)) {
        fre2017_B.Preventdiv1_o = fre2017_P.CoreSubsys.zero_Value;
      }

      // End of Switch: '<S15>/bottom side of the right box1'
    }

    // End of Switch: '<S15>/right side of the left box'

    // ForEachSliceAssignment: '<S15>/ImpAsg_InsertedFor_scan_y_out_at_inport_0' 
    fre2017_B.ImpAsg_InsertedFor_scan_y_f[ForEach_itr_h] =
      fre2017_B.Preventdiv1_o;
  }

  // End of Outputs for SubSystem: '<S5>/Box check left side'

  // Sum: '<S17>/Sum of Elements1'
  i_1 = 0;
  i_0 = 0;
  fre2017_B.SumofElements1 = -0.0;
  for (i = 0; i < 360; i++) {
    fre2017_B.SumofElements1 += fre2017_B.ImpAsg_InsertedFor_scan_y_f[i];

    // Find: '<S17>/Find Nonzero Elements1'
    if (fre2017_B.ImpAsg_InsertedFor_scan_y_f[i_0] != 0.0) {
      i_1++;
    }

    i_0++;
  }

  // End of Sum: '<S17>/Sum of Elements1'

  // Find: '<S17>/Find Nonzero Elements1'
  fre2017_DW.FindNonzeroElements1_DIMS1 = i_1;

  // Selector: '<S17>/Selector3'
  fre2017_DW.Selector3_DIMS1 = fre2017_DW.FindNonzeroElements1_DIMS1;

  // Switch: '<S17>/Prevent div 1' incorporates:
  //   Constant: '<S17>/Const2'
  //   Width: '<S17>/Width1'

  if (fre2017_DW.Selector3_DIMS1 != 0) {
    fre2017_B.Preventdiv1_o = fre2017_DW.Selector3_DIMS1;
  } else {
    fre2017_B.Preventdiv1_o = fre2017_P.Const2_Value;
  }

  // End of Switch: '<S17>/Prevent div 1'

  // Gain: '<S17>/Gain1' incorporates:
  //   Constant: '<S17>/max. Points1'
  //   Product: '<S17>/Divide3'

  fre2017_B.Gain1 = fre2017_B.Preventdiv1_o / fre2017_P.maxPoints1_Value *
    fre2017_P.Gain1_Gain_o;

  // Outputs for Atomic SubSystem: '<Root>/Subscribe4'
  // Start for MATLABSystem: '<S9>/SourceBlock' incorporates:
  //   Inport: '<S24>/In1'
  //   MATLABSystem: '<S9>/SourceBlock'

  varargout_1 = Sub_fre2017_8.getLatestMessage(&fre2017_B.varargout_2_m);

  // Outputs for Enabled SubSystem: '<S9>/Enabled Subsystem' incorporates:
  //   EnablePort: '<S24>/Enable'

  if (varargout_1) {
    fre2017_B.In1_k = fre2017_B.varargout_2_m;
  }

  // End of Start for MATLABSystem: '<S9>/SourceBlock'
  // End of Outputs for SubSystem: '<S9>/Enabled Subsystem'
  // End of Outputs for SubSystem: '<Root>/Subscribe4'

  // MATLAB Function: '<Root>/MATLAB Function'
  // MATLAB Function 'MATLAB Function': '<S3>:1'
  // '<S3>:1:2' direction = pattern(2:2:end);
  // '<S3>:1:4' row = pattern(1:2:end);
  for (i_0 = 0; i_0 < 64; i_0++) {
    fre2017_B.direction[i_0] = fre2017_B.In1_k.Buttons[(i_0 << 1) + 1];
    fre2017_B.row[i_0] = fre2017_B.In1_k.Buttons[i_0 << 1];
  }

  // End of MATLAB Function: '<Root>/MATLAB Function'

  // Outputs for Atomic SubSystem: '<Root>/Subscribe2'
  // Start for MATLABSystem: '<S8>/SourceBlock' incorporates:
  //   Inport: '<S23>/In1'
  //   MATLABSystem: '<S8>/SourceBlock'

  varargout_1 = Sub_fre2017_7.getLatestMessage(&varargout_2);

  // Outputs for Enabled SubSystem: '<S8>/Enabled Subsystem' incorporates:
  //   EnablePort: '<S23>/Enable'

  if (varargout_1) {
    fre2017_B.In1_e = varargout_2;
  }

  // End of Start for MATLABSystem: '<S8>/SourceBlock'
  // End of Outputs for SubSystem: '<S8>/Enabled Subsystem'
  // End of Outputs for SubSystem: '<Root>/Subscribe2'

  // Chart: '<Root>/Chart'
  if (fre2017_DW.temporalCounter_i1 < MAX_uint32_T) {
    fre2017_DW.temporalCounter_i1++;
  }

  // Gateway: Chart
  // During: Chart
  if (fre2017_DW.is_active_c3_fre2017 == 0U) {
    // Entry: Chart
    fre2017_DW.is_active_c3_fre2017 = 1U;

    // Entry Internal: Chart
    // Transition: '<S2>:62'
    // '<S2>:62:1' i=1;
    fre2017_DW.i = 1.0;
    fre2017_DW.is_c3_fre2017 = fre2017_IN_Manual;

    // Entry 'Manual': '<S2>:38'
    // '<S2>:38:1' manual = true;
    fre2017_B.manual = true;
  } else {
    switch (fre2017_DW.is_c3_fre2017) {
     case fre2017_IN_Automatic:
      fre2017_Automatic(&fre2017_B.Gain1, &fre2017_B.Gain, fre2017_B.row,
                        fre2017_B.direction);
      break;

     case fre2017_IN_Manual:
      // During 'Manual': '<S2>:38'
      // '<S2>:60:1' sf_internal_predicateOutput = ...
      // '<S2>:60:1' state == true;
      if (fre2017_B.In1_e.Data) {
        // Transition: '<S2>:60'
        // Exit 'Manual': '<S2>:38'
        // '<S2>:38:1' manual = false;
        fre2017_B.manual = false;
        fre2017_DW.is_c3_fre2017 = fre2017_IN_Automatic;

        // Entry Internal 'Automatic': '<S2>:39'
        // Transition: '<S2>:2'
        fre2017_DW.is_Automatic = fre2017_IN_StartFirstMeter;
        fre2017_DW.temporalCounter_i1 = 0U;

        // Entry 'StartFirstMeter': '<S2>:64'
        // '<S2>:64:1' straightOn = true;
        fre2017_B.straightOn = true;
      }
      break;

     default:
      fre2017_B.inReihe = false;

      // During 'Stop': '<S2>:86'
      // '<S2>:87:1' sf_internal_predicateOutput = ...
      // '<S2>:87:1' state == false;
      if (!fre2017_B.In1_e.Data) {
        // Transition: '<S2>:87'
        fre2017_DW.is_c3_fre2017 = fre2017_IN_Manual;

        // Entry 'Manual': '<S2>:38'
        // '<S2>:38:1' manual = true;
        fre2017_B.manual = true;
      }
      break;
    }
  }

  // End of Chart: '<Root>/Chart'

  // Outputs for Enabled SubSystem: '<Root>/in_row' incorporates:
  //   EnablePort: '<S10>/Enable'

  if (fre2017_B.inReihe) {
    // Switch: '<S10>/Prevent div 1' incorporates:
    //   Constant: '<S10>/const2'

    if (!(fre2017_B.Gain >= fre2017_P.Preventdiv1_Threshold)) {
      fre2017_B.Divide = fre2017_P.const2_Value;
    }

    // End of Switch: '<S10>/Prevent div 1'

    // Switch: '<S10>/Prevent div 2' incorporates:
    //   Constant: '<S10>/const3'
    //   Product: '<S17>/Divide2'

    if (fre2017_B.Gain1 >= fre2017_P.Preventdiv2_Threshold) {
      fre2017_B.SumofElements1 /= fre2017_B.Preventdiv1_o;
    } else {
      fre2017_B.SumofElements1 = fre2017_P.const3_Value;
    }

    // End of Switch: '<S10>/Prevent div 2'

    // Trigonometry: '<S10>/Trigonometric Function2' incorporates:
    //   Constant: '<S10>/const1'
    //   Constant: '<S10>/scan_box_height//2'
    //   Product: '<S10>/Divide'
    //   Sum: '<S10>/Subtract'
    //   Sum: '<S10>/Subtract1'

    fre2017_B.Preventdiv1_o = fre2017_rt_atan2d_snf_cordic11
      (fre2017_B.SumofElements1 - (fre2017_B.SumofElements1 - fre2017_B.Divide) /
       fre2017_P.const1_Value, fre2017_P.scan_box_height2_Value);

    // Product: '<S10>/Product' incorporates:
    //   Abs: '<S10>/Abs'
    //   Constant: '<S10>/Constant'
    //   Gain: '<S10>/cmd_vel_x_max'
    //   Gain: '<S10>/gain'
    //   Gain: '<S10>/secure_slow'
    //   Sum: '<S10>/Add'
    //   Sum: '<S10>/Subtract2'
    //   Trigonometry: '<S10>/Trigonometric Function'

    fre2017_B.Merge[0] = (fre2017_P.Constant_Value_p - fabs(fre2017_B.Divide +
      fre2017_B.SumofElements1) * fre2017_P.gain_Gain) *
      (fre2017_P.cmd_vel_x_max_Gain * cos(fre2017_B.Preventdiv1_o) *
       fre2017_P.secure_slow_Gain);

    // Gain: '<S10>/secure_slow1' incorporates:
    //   Gain: '<S10>/cmd_vel_yaw_max'
    //   Trigonometry: '<S10>/Trigonometric Function1'

    fre2017_B.Merge[1] = fre2017_P.cmd_vel_yaw_max_Gain * sin
      (fre2017_B.Preventdiv1_o) * fre2017_P.secure_slow1_Gain;
  }

  // End of Outputs for SubSystem: '<Root>/in_row'

  // Outputs for Enabled SubSystem: '<Root>/turn left' incorporates:
  //   EnablePort: '<S13>/Enable'

  if (fre2017_B.leftTurn) {
    // Gain: '<S25>/Gain1' incorporates:
    //   Constant: '<S13>/Drehwinkel'

    fre2017_B.SumofElements1 = fre2017_P.Gain1_Gain * fre2017_P.Drehwinkel_Value;

    // Product: '<S13>/Divide' incorporates:
    //   Constant: '<Root>/turn_time'
    //   Constant: '<S13>/Kurvenradius'
    //   Product: '<S13>/Product'

    fre2017_B.Merge[0] = fre2017_P.Kurvenradius_Value * fre2017_B.SumofElements1
      / fre2017_P.turn_time_Value;

    // Product: '<S13>/Divide1' incorporates:
    //   Constant: '<Root>/turn_time'

    fre2017_B.Merge[1] = fre2017_B.SumofElements1 / fre2017_P.turn_time_Value;
  }

  // End of Outputs for SubSystem: '<Root>/turn left'

  // Outputs for Enabled SubSystem: '<Root>/turn right' incorporates:
  //   EnablePort: '<S14>/Enable'

  if (fre2017_B.rightTurn) {
    // Gain: '<S26>/Gain1' incorporates:
    //   Constant: '<S14>/Drehwinkel'

    fre2017_B.SumofElements1 = fre2017_P.Gain1_Gain_j *
      fre2017_P.Drehwinkel_Value_n;

    // Product: '<S14>/Divide' incorporates:
    //   Constant: '<Root>/turn_time'
    //   Constant: '<S14>/Kurvenradius'
    //   Product: '<S14>/Product'

    fre2017_B.Merge[0] = fre2017_P.Kurvenradius_Value_o *
      fre2017_B.SumofElements1 / fre2017_P.turn_time_Value;

    // Gain: '<S14>/Gain' incorporates:
    //   Constant: '<Root>/turn_time'
    //   Product: '<S14>/Divide1'

    fre2017_B.Merge[1] = fre2017_B.SumofElements1 / fre2017_P.turn_time_Value *
      fre2017_P.Gain_Gain;
  }

  // End of Outputs for SubSystem: '<Root>/turn right'

  // Outputs for Enabled SubSystem: '<Root>/straight on' incorporates:
  //   EnablePort: '<S12>/Enable'

  if (fre2017_B.straightOn) {
    // Constant: '<S12>/Rotations- geschwindigkeit'
    fre2017_B.Merge[1] = fre2017_P.Rotationsgeschwindigkeit_Value;

    // Constant: '<S12>/Translations- geschwindigkeit'
    fre2017_B.Merge[0] = fre2017_P.Translationsgeschwindigkeit_Val;
  }

  // End of Outputs for SubSystem: '<Root>/straight on'

  // Outputs for Atomic SubSystem: '<Root>/Subscribe1'
  // Start for MATLABSystem: '<S7>/SourceBlock' incorporates:
  //   Inport: '<S22>/In1'
  //   MATLABSystem: '<S7>/SourceBlock'

  varargout_1 = Sub_fre2017_6.getLatestMessage(&fre2017_B.BusAssignment);

  // Outputs for Enabled SubSystem: '<S7>/Enabled Subsystem' incorporates:
  //   EnablePort: '<S22>/Enable'

  if (varargout_1) {
    fre2017_B.In1_a = fre2017_B.BusAssignment;
  }

  // End of Start for MATLABSystem: '<S7>/SourceBlock'
  // End of Outputs for SubSystem: '<S7>/Enabled Subsystem'
  // End of Outputs for SubSystem: '<Root>/Subscribe1'

  // Outputs for Enabled SubSystem: '<Root>/manual drive' incorporates:
  //   EnablePort: '<S11>/Enable'

  if (fre2017_B.manual) {
    // Inport: '<S11>/lin.x'
    fre2017_B.Merge[0] = fre2017_B.In1_a.Linear.X;

    // Inport: '<S11>/ang.z '
    fre2017_B.Merge[1] = fre2017_B.In1_a.Angular.Z;
  }

  // End of Outputs for SubSystem: '<Root>/manual drive'

  // BusAssignment: '<Root>/Bus Assignment' incorporates:
  //   Constant: '<S1>/Constant'

  fre2017_B.BusAssignment = fre2017_P.Constant_Value_cv;
  fre2017_B.BusAssignment.Linear.X = fre2017_B.Merge[0];
  fre2017_B.BusAssignment.Angular.Z = fre2017_B.Merge[1];

  // Outputs for Atomic SubSystem: '<Root>/Publish'
  // Start for MATLABSystem: '<S4>/SinkBlock' incorporates:
  //   MATLABSystem: '<S4>/SinkBlock'

  Pub_fre2017_860.publish(&fre2017_B.BusAssignment);

  // End of Outputs for SubSystem: '<Root>/Publish'
}

// Model initialize function
void fre2017_initialize(void)
{
  // Registration code

  // initialize error status
  rtmSetErrorStatus(fre2017_M, (NULL));

  // block I/O
  (void) memset(((void *) &fre2017_B), 0,
                sizeof(B_fre2017_T));

  // states (dwork)
  (void) memset((void *)&fre2017_DW, 0,
                sizeof(DW_fre2017_T));

  {
    static const char_T tmp[8] = { '/', 'c', 'm', 'd', '_', 'v', 'e', 'l' };

    static const char_T tmp_0[15] = { '/', 't', 'e', 'l', 'e', 'o', 'p', '/',
      'c', 'm', 'd', '_', 'v', 'e', 'l' };

    static const char_T tmp_1[22] = { '/', 't', 'e', 'l', 'e', 'o', 'p', '/',
      'a', 'u', 't', 'o', 'm', 'a', 't', 'i', 'c', '_', 'm', 'o', 'd', 'e' };

    static const char_T tmp_2[25] = { '/', 't', 'e', 'l', 'e', 'o', 'p', '/',
      'm', 'o', 'v', 'e', 'm', 'e', 'n', 't', '_', 's', 'e', 'q', 'u', 'e', 'n',
      'c', 'e' };

    static const char_T tmp_3[5] = { '/', 's', 'c', 'a', 'n' };

    char_T tmp_4[9];
    char_T tmp_5[16];
    char_T tmp_6[6];
    int32_T i;

    // Start for Atomic SubSystem: '<Root>/Subscribe'
    // Start for MATLABSystem: '<S6>/SourceBlock'
    fre2017_DW.obj_lb.isInitialized = 0;
    fre2017_DW.obj_lb.isInitialized = 1;
    for (i = 0; i < 5; i++) {
      tmp_6[i] = tmp_3[i];
    }

    tmp_6[5] = '\x00';
    Sub_fre2017_5.createSubscriber(tmp_6, fre2017_MessageQueueLen);

    // End of Start for MATLABSystem: '<S6>/SourceBlock'
    // End of Start for SubSystem: '<Root>/Subscribe'

    // Start for Atomic SubSystem: '<Root>/Subscribe4'
    // Start for MATLABSystem: '<S9>/SourceBlock'
    fre2017_DW.obj_e.isInitialized = 0;
    fre2017_DW.obj_e.isInitialized = 1;
    for (i = 0; i < 25; i++) {
      fre2017_B.cv0[i] = tmp_2[i];
    }

    fre2017_B.cv0[25] = '\x00';
    Sub_fre2017_8.createSubscriber(fre2017_B.cv0, fre2017_MessageQueueLen);

    // End of Start for MATLABSystem: '<S9>/SourceBlock'
    // End of Start for SubSystem: '<Root>/Subscribe4'

    // Start for Atomic SubSystem: '<Root>/Subscribe2'
    // Start for MATLABSystem: '<S8>/SourceBlock'
    fre2017_DW.obj_n.isInitialized = 0;
    fre2017_DW.obj_n.isInitialized = 1;
    for (i = 0; i < 22; i++) {
      fre2017_B.cv1[i] = tmp_1[i];
    }

    fre2017_B.cv1[22] = '\x00';
    Sub_fre2017_7.createSubscriber(fre2017_B.cv1, fre2017_MessageQueueLen);

    // End of Start for MATLABSystem: '<S8>/SourceBlock'
    // End of Start for SubSystem: '<Root>/Subscribe2'

    // Start for Atomic SubSystem: '<Root>/Subscribe1'
    // Start for MATLABSystem: '<S7>/SourceBlock'
    fre2017_DW.obj_l.isInitialized = 0;
    fre2017_DW.obj_l.isInitialized = 1;
    for (i = 0; i < 15; i++) {
      tmp_5[i] = tmp_0[i];
    }

    tmp_5[15] = '\x00';
    Sub_fre2017_6.createSubscriber(tmp_5, fre2017_MessageQueueLen);

    // End of Start for MATLABSystem: '<S7>/SourceBlock'
    // End of Start for SubSystem: '<Root>/Subscribe1'

    // Start for Atomic SubSystem: '<Root>/Publish'
    // Start for MATLABSystem: '<S4>/SinkBlock'
    fre2017_DW.obj.isInitialized = 0;
    fre2017_DW.obj.isInitialized = 1;
    for (i = 0; i < 8; i++) {
      tmp_4[i] = tmp[i];
    }

    tmp_4[8] = '\x00';
    Pub_fre2017_860.createPublisher(tmp_4, fre2017_MessageQueueLen);

    // End of Start for MATLABSystem: '<S4>/SinkBlock'
    // End of Start for SubSystem: '<Root>/Publish'

    // SystemInitialize for Atomic SubSystem: '<Root>/Subscribe'
    // SystemInitialize for Enabled SubSystem: '<S6>/Enabled Subsystem'
    // SystemInitialize for Outport: '<S21>/Out1'
    fre2017_B.In1 = fre2017_P.Out1_Y0;

    // End of SystemInitialize for SubSystem: '<S6>/Enabled Subsystem'
    // End of SystemInitialize for SubSystem: '<Root>/Subscribe'

    // SystemInitialize for Atomic SubSystem: '<Root>/Subscribe4'
    // SystemInitialize for Enabled SubSystem: '<S9>/Enabled Subsystem'
    // SystemInitialize for Outport: '<S24>/Out1'
    fre2017_B.In1_k = fre2017_P.Out1_Y0_n;

    // End of SystemInitialize for SubSystem: '<S9>/Enabled Subsystem'
    // End of SystemInitialize for SubSystem: '<Root>/Subscribe4'

    // SystemInitialize for Atomic SubSystem: '<Root>/Subscribe2'
    // SystemInitialize for Enabled SubSystem: '<S8>/Enabled Subsystem'
    // SystemInitialize for Outport: '<S23>/Out1'
    fre2017_B.In1_e = fre2017_P.Out1_Y0_m;

    // End of SystemInitialize for SubSystem: '<S8>/Enabled Subsystem'
    // End of SystemInitialize for SubSystem: '<Root>/Subscribe2'

    // SystemInitialize for Chart: '<Root>/Chart'
    fre2017_DW.is_Automatic = fre2017_IN_NO_ACTIVE_CHILD;
    fre2017_DW.is_TurnLeft = fre2017_IN_NO_ACTIVE_CHILD;
    fre2017_DW.is_TurnRight = fre2017_IN_NO_ACTIVE_CHILD;
    fre2017_DW.temporalCounter_i1 = 0U;
    fre2017_DW.is_active_c3_fre2017 = 0U;
    fre2017_DW.is_c3_fre2017 = fre2017_IN_NO_ACTIVE_CHILD;

    // SystemInitialize for Atomic SubSystem: '<Root>/Subscribe1'
    // SystemInitialize for Enabled SubSystem: '<S7>/Enabled Subsystem'
    // SystemInitialize for Outport: '<S22>/Out1'
    fre2017_B.In1_a = fre2017_P.Out1_Y0_k;

    // End of SystemInitialize for SubSystem: '<S7>/Enabled Subsystem'
    // End of SystemInitialize for SubSystem: '<Root>/Subscribe1'

    // SystemInitialize for Merge: '<Root>/Merge'
    fre2017_B.Merge[0] = fre2017_P.Merge_InitialOutput;
    fre2017_B.Merge[1] = fre2017_P.Merge_InitialOutput;
  }
}

// Model terminate function
void fre2017_terminate(void)
{
  // Terminate for Atomic SubSystem: '<Root>/Subscribe'
  // Start for MATLABSystem: '<S6>/SourceBlock' incorporates:
  //   Terminate for MATLABSystem: '<S6>/SourceBlock'

  if (fre2017_DW.obj_lb.isInitialized == 1) {
    fre2017_DW.obj_lb.isInitialized = 2;
  }

  // End of Start for MATLABSystem: '<S6>/SourceBlock'
  // End of Terminate for SubSystem: '<Root>/Subscribe'

  // Terminate for Atomic SubSystem: '<Root>/Subscribe4'
  // Start for MATLABSystem: '<S9>/SourceBlock' incorporates:
  //   Terminate for MATLABSystem: '<S9>/SourceBlock'

  if (fre2017_DW.obj_e.isInitialized == 1) {
    fre2017_DW.obj_e.isInitialized = 2;
  }

  // End of Start for MATLABSystem: '<S9>/SourceBlock'
  // End of Terminate for SubSystem: '<Root>/Subscribe4'

  // Terminate for Atomic SubSystem: '<Root>/Subscribe2'
  // Start for MATLABSystem: '<S8>/SourceBlock' incorporates:
  //   Terminate for MATLABSystem: '<S8>/SourceBlock'

  if (fre2017_DW.obj_n.isInitialized == 1) {
    fre2017_DW.obj_n.isInitialized = 2;
  }

  // End of Start for MATLABSystem: '<S8>/SourceBlock'
  // End of Terminate for SubSystem: '<Root>/Subscribe2'

  // Terminate for Atomic SubSystem: '<Root>/Subscribe1'
  // Start for MATLABSystem: '<S7>/SourceBlock' incorporates:
  //   Terminate for MATLABSystem: '<S7>/SourceBlock'

  if (fre2017_DW.obj_l.isInitialized == 1) {
    fre2017_DW.obj_l.isInitialized = 2;
  }

  // End of Start for MATLABSystem: '<S7>/SourceBlock'
  // End of Terminate for SubSystem: '<Root>/Subscribe1'

  // Terminate for Atomic SubSystem: '<Root>/Publish'
  // Start for MATLABSystem: '<S4>/SinkBlock' incorporates:
  //   Terminate for MATLABSystem: '<S4>/SinkBlock'

  if (fre2017_DW.obj.isInitialized == 1) {
    fre2017_DW.obj.isInitialized = 2;
  }

  // End of Start for MATLABSystem: '<S4>/SinkBlock'
  // End of Terminate for SubSystem: '<Root>/Publish'
}

//
// File trailer for generated code.
//
// [EOF]
//
